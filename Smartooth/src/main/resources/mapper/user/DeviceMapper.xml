<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="co.smartooth.mapper.DeviceMapper">


	<!-- 회원 아이디와 비밀번호로 존재 여부 확인 :: true = 1, false = 0 -->
    <select id="loginChkByIdPwd" parameterType="co.smartooth.vo.LoginVO" resultType="Integer">
        SELECT COUNT(*)
          FROM ST_USER
		 WHERE 1=1
		     AND USER_ID = #{userId}
		     AND USER_PWD = #{userPwd}
    </select>


	<!-- 	회원 아이디가 존재하는지 여부 확인 :: true = 1, false = 0 -->
    <select id="isIdExist" parameterType="String" resultType="Integer">
        SELECT COUNT(*)
          FROM ST_USER
		 WHERE 1=1
		     AND USER_ID = #{userId}
    </select>


	<!-- 	회원 : 로그인 처리가 정상적으로 완료될 경우, USER_AUTH_TOKEN을 UPDATE -->
    <update id="updateUserAuthToken" parameterType="co.smartooth.vo.LoginVO">
        UPDATE ST_USER
  			 SET  USER_AUTH_TOKEN = #{userAuthToken}
	     WHERE  1=1
	     AND USER_ID = #{userId}
    </update>
    
    
    <!-- 회원 : 로그인 완료 후 로그인 LOG를 기록-->
	<insert id="insertUserLoginHistory" parameterType="co.smartooth.vo.LoginVO">
		INSERT INTO ST_USER_LOGIN_HIST
			(	
				USER_NO
				,USER_ID
				,USER_TYPE
				,LOGIN_DT
				,LOGIN_RESULT_CODE
				,LOGIN_IP
			)
		VALUES
			(
				#{userNo}
				,#{userId}
				,#{userType}
				,SYSDATE()
				,#{loginResultCode}
				,#{loginIp}
			)
	</insert>
    
    
    <!-- 회원 접속일 UPDATE -->
    <update id="updateLoginDt" parameterType="co.smartooth.vo.LoginVO">
		UPDATE ST_USER
  			 SET  LOGIN_DT = #{loginDt}
	     WHERE  1=1
	     AND USER_ID = #{userId}
    </update>
    
<!--     <select id="selectUserCnt" resultType="Integer"> -->
<!--         SELECT COUNT(*) FROM ST_USER -->
<!--     </select> -->
    
    
<!--     <resultMap type="co.smartooth.dto.UserDto" id="selectUserList"> -->
<!--         <result property="userNo" column="USER_NO"/> -->
<!--         <result property="userId" column="USER_ID"/> -->
<!--         <result property="userNm" column="USER_NAME"/> -->
<!--         <result property="userPwd" column="USER_PWD"/> -->
<!--         <result property="userNickname" column="USER_NICKNAME"/> -->
<!--         <result property="birthDay" column="BIRTHDAY"/> -->
<!--         <result property="sex" column="SEX"/> -->
<!--         <result property="email" column="EMAIL"/> -->
<!--         <result property="emailYn" column="EMAIL_YN"/> -->
<!--         <result property="telNum" column="TEL_NUM"/> -->
<!--         <result property="deleteYn" column="DELETE_YN"/> -->
<!--         <result property="deleteDt" column="DELETE_DT"/> -->
<!--         <result property="loginCk" column="LOGIN_CK"/> -->
<!--         <result property="rgstDt" column="RGST_DT"/> -->
<!--     </resultMap> -->
</mapper>